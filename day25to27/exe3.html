<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<body>
    <select id="year-select">
    </select>
    <span>年</span>

    <select id="month-select">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
    </select>
    <span>月</span>

    <select id="day-select">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
    </select>
    <span>日</span>

    <select id="hour-select">
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
    </select>
    <span>时</span>

    <select id="minite-select">
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
        <option value="32">32</option>
        <option value="33">33</option>
        <option value="34">34</option>
        <option value="35">35</option>
        <option value="36">36</option>
        <option value="37">37</option>
        <option value="38">38</option>
        <option value="39">39</option>
        <option value="40">40</option>
        <option value="41">41</option>
        <option value="42">42</option>
        <option value="43">43</option>
        <option value="44">44</option>
        <option value="45">45</option>
        <option value="46">46</option>
        <option value="47">47</option>
        <option value="48">48</option>
        <option value="49">49</option>
        <option value="50">50</option>
        <option value="51">51</option>
        <option value="52">52</option>
        <option value="53">53</option>
        <option value="54">54</option>
        <option value="55">55</option>
        <option value="56">56</option>
        <option value="57">57</option>
        <option value="58">58</option>
        <option value="59">59</option>
    </select>
    <span>分</span>

    <select id="second-select">
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
        <option value="32">32</option>
        <option value="33">33</option>
        <option value="34">34</option>
        <option value="35">35</option>
        <option value="36">36</option>
        <option value="37">37</option>
        <option value="38">38</option>
        <option value="39">39</option>
        <option value="40">40</option>
        <option value="41">41</option>
        <option value="42">42</option>
        <option value="43">43</option>
        <option value="44">44</option>
        <option value="45">45</option>
        <option value="46">46</option>
        <option value="47">47</option>
        <option value="48">48</option>
        <option value="49">49</option>
        <option value="50">50</option>
        <option value="51">51</option>
        <option value="52">52</option>
        <option value="53">53</option>
        <option value="54">54</option>
        <option value="55">55</option>
        <option value="56">56</option>
        <option value="57">57</option>
        <option value="58">58</option>
        <option value="59">59</option>
    </select>
    <span>秒</span>

    <p id="result-wrapper">现在距离 2001年1月1日星期X HH:MM:SS 还有 X 天 X 小时 X 分 X 秒</p>
    <script>
        let timer = null;
        //定义全局定时器
        let resultWrapper = document.getElementById("result-wrapper");
        //显示结果容器 
        let yearSelect = document.getElementById("year-select");
        let yearSelectText = "";
        for (let i = 1900; i < 2051; i++) {
            yearSelectText = yearSelectText + "<option value=" + i + ">" + i + "</option>";
        }
        yearSelect.innerHTML = yearSelectText;
        //实现年列表
        let monthSelect = document.getElementById("month-select");
        let daySelect = document.getElementById("day-select");
        let hourSelect = document.getElementById("hour-select");
        let miniteSelect = document.getElementById("minite-select");
        let secondSelect = document.getElementById("second-select");
        yearSelect.addEventListener("change", processDays, false);
        monthSelect.addEventListener("change", processDays, false);
        //选择年月确定天数
        yearSelect.addEventListener("change", reSetShow, false);
        monthSelect.addEventListener("change", reSetShow, false);
        daySelect.addEventListener("change", reSetShow, false);
        hourSelect.addEventListener("change", reSetShow, false);
        miniteSelect.addEventListener("change", reSetShow, false);
        secondSelect.addEventListener("change", reSetShow, false);
        //刷新显式
        function processDays() {
            let currentYear = parseInt(yearSelect.value);
            let currentmonth = parseInt(monthSelect.value);
            let daySelectText1 = "";
            let daySelectText2 = "";
            let daySelectText3 = "";
            let daySelectText4 = "";
            for (let i = 1; i < 29; i++) {
                daySelectText1 = daySelectText1 + "<option value=" + i + ">" + i + "</option>";
            }
            for (let i = 1; i < 30; i++) {
                daySelectText2 = daySelectText2 + "<option value=" + i + ">" + i + "</option>";
            }
            for (let i = 1; i < 31; i++) {
                daySelectText3 = daySelectText3 + "<option value=" + i + ">" + i + "</option>";
            }
            for (let i = 1; i < 32; i++) {
                daySelectText4 = daySelectText4 + "<option value=" + i + ">" + i + "</option>";
            }
            if ((currentYear % 4 == 0 && currentYear % 100 != 0) || currentYear % 400 == 0) {
                //该年是闰年
                if (currentmonth == 2) {
                    daySelect.innerHTML = daySelectText2;
                } else {
                    if (currentmonth == 1 || currentmonth == 3 || currentmonth == 5 || currentmonth == 7 || currentmonth == 8 || currentmonth == 10 || currentmonth == 12) {
                        daySelect.innerHTML = daySelectText4;
                    } else {
                        daySelect.innerHTML = daySelectText3;
                    }
                }
            } else {
                if (currentmonth == 2) {
                    daySelect.innerHTML = daySelectText1;
                } else {
                    if (currentmonth == 1 || currentmonth == 3 || currentmonth == 5 || currentmonth == 7 || currentmonth == 8 || currentmonth == 10 || currentmonth == 12) {
                        daySelect.innerHTML = daySelectText4;
                    } else {
                        daySelect.innerHTML = daySelectText3;
                    }
                }
            }
        }
        //每月日个数处理函数
        function reSetShow() {
            let selectedYear = parseInt(yearSelect.value);
            let selectedMonth = parseInt(monthSelect.value);
            let selectedDay = parseInt(daySelect.value);
            let selectedHour = parseInt(hourSelect.value);
            let selectedMinite = parseInt(miniteSelect.value);
            let selectedSecond = parseInt(secondSelect.value);
            let fixedString = selectedYear + "年" + selectedMonth + "月" + selectedDay + "日" + " " + CaculateWeekDay(selectedYear, selectedMonth, selectedDay) + " " + toDouble(selectedHour) + ":" + toDouble(selectedMinite) + ":" + toDouble(selectedSecond) + " ";
            clearInterval(timer);
            //先关闭已开启的定时器
            timer = setInterval(refreshShow, 1000);
            function refreshShow() {
                let delta_Time = (new Date(selectedYear, selectedMonth - 1, selectedDay, selectedHour, selectedMinite, selectedSecond)) - (new Date());
                console.log(delta_Time);
                let delta_days = Math.abs(parseInt(delta_Time / 1000 / 60 / 60 / 24, 10)); //计算剩余的天数 
                let delta_hours = Math.abs(parseInt(delta_Time / 1000 / 60 / 60 % 24, 10)); //计算剩余的小时 
                let delta_minutes = Math.abs(parseInt(delta_Time / 1000 / 60 % 60, 10));//计算剩余的分钟 
                let delta_seconds = Math.abs(parseInt(delta_Time / 1000 % 60, 10));//计算剩余的秒数 
                if (Math.abs(delta_Time) <= 100) {
                    resultWrapper.textContent = "就是现在！";
                } else if (delta_Time > 100) {
                    resultWrapper.textContent = "现在距离 " + fixedString + " 还有 " + delta_days + "天" + delta_hours + "小时" + delta_minutes + "分" + delta_seconds + "秒";
                } else {
                    resultWrapper.textContent = "现在距离 " + fixedString + " 已经过去 " + delta_days + "天" + delta_hours + "小时" + delta_minutes + "分" + delta_seconds + "秒";
                }
            }

        }
        //重置显示函数

        function CaculateWeekDay(y, m, d) {
            let year = y;
            let month = m;
            let day = d;
            let totaldays = 0;
            let result;

            for (let i = 1900; i < year; i++) {
                if ((i % 4 == 0 && i % 100 != 0) || (i % 400 == 0)) {
                    totaldays += 366;
                } else {
                    totaldays += 365;
                }
            }

            var isrun = ((year % 4 == 0 && year % 100 != 0) || (year % 400 == 0)) ? 1 : 0;

            switch (month - 1) {
                case 11:
                    totaldays += 30;
                case 10:
                    totaldays += 31;
                case 9:
                    totaldays += 30;
                case 8:
                    totaldays += 31;
                case 7:
                    totaldays += 31;
                case 6:
                    totaldays += 30;
                case 5:
                    totaldays += 31;
                case 4:
                    totaldays += 30;
                case 3:
                    totaldays += 31;
                case 2:
                    isrun ? (totaldays += 29) : (totaldays += 28);
                case 1:
                    totaldays += 31;
            }

            totaldays += day;

            switch (totaldays % 7) {
                case 1:
                    result = "周一";
                    break;
                case 2:
                    result = "周二";
                    break;
                case 3:
                    result = "周三";
                    break;
                case 4:
                    result = "周四";
                    break;
                case 5:
                    result = "周五";
                    break;
                case 6:
                    result = "周六";
                    break;
                case 0:
                    result = "周日";
                    break;
            }
            return result;
        }//计算星期函数
        function toDouble(n) {
            let result;
            if (n < 10) {
                result = "0" + n
            } else {
                result = n;
            }
            return result;
        }//补零函数

    </script>
</body>

</html>